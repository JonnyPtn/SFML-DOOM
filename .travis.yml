language:
  - cpp

os: 
  - linux
  - osx

compiler:
  - gcc
  - clang

addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    #SFML dependencies:
    - libopenal-dev
    - libjpeg-dev
    - libudev-dev
    - libxrandr-dev
    - libfreetype6-dev
    - libvorbis-dev
    - libflac-dev
    - gcc-5
    - g++-5

install: 
  #Update the g++ symbol first
  - if [ "$CXX" == "g++" ]; then export CXX="g++-5"; fi
  - git clone -b cmakefix https://github.com/jonnyptn/sfml
  #Apply patch for the hidden cpu symbol warning
  - curl https://gitlab.peach-bun.com/pinion/SFML/commit/3383b4a472f0bd16a8161fb8760cd3e6333f1782.patch | patch -p1
  - cd sfml
  - mkdir install
  - cmake . -DCMAKE_INSTALL_PREFIX=./install -DSFML_BUILD_FRAMEWORKS=FALSE -DBUILD_SHARED_LIBS=TRUE
  - make install
  - cd ../

script:
  - mkdir build
  - cd build
  - cmake .. -DSFML_ROOT=./sfml/install
  - make